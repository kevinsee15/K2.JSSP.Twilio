{"version":3,"file":"test.js","sources":["../src/test.ts"],"sourcesContent":["\r\n\r\nfunction run(url: string, data: string, requestType: string, cb) {\r\n    var xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState !== 4)\r\n                return;\r\n            if (xhr.status == 201) {\r\n                //console.log(\"ExecuteRequest XHR status: \" + xhr.status + \",\" + xhr.responseText);\r\n                var obj = JSON.parse(xhr.responseText);\r\n                if (typeof cb === 'function')\r\n                    cb(obj);\r\n            }\r\n            else if (xhr.status == 204) {\r\n                if (typeof cb === 'function')\r\n                    cb(xhr.responseText);\r\n            }\r\n            else if (xhr.status == 200) {\r\n                var obj = JSON.parse(xhr.responseText);\r\n                //console.log(\"ExecuteRequest XHR status: \" + xhr.status + \",\" + xhr.responseText);\r\n                //console.log(\"ExecuteRequest cb type of: \" + (typeof cb).toString());\r\n                if (typeof cb === 'function')\r\n                    cb(obj);\r\n            }\r\n            else if (xhr.status == 202) {\r\n                if (typeof cb === 'function')\r\n                    cb(null);\r\n            }\r\n            else if (xhr.status == 400) {\r\n                // This is a bad request, return error to UI\r\n                var obj = JSON.parse(xhr.responseText);\r\n                throw new Error(obj.error.code + \": \" + obj.error.message);\r\n            }\r\n            else if (xhr.status == 404) {\r\n                var obj = JSON.parse(xhr.responseText);\r\n                 // This is to supress an error that happens with team archive/unarchive\r\n                var errorMessage = obj.error.message;            \r\n                if (errorMessage.startswith == \"No Team found with Group id\") {\r\n                    // do nothing - supress error\r\n                }\r\n                else {\r\n                    throw new Error(obj.error.code + \": \" + obj.error.message);\r\n                }\r\n                //console.log(\"MSTeamsConnector ExecuteRequest: Failed with 404 error.\");\r\n                //throw new Error(obj.error.code + \" error: \" + obj.error.message);\r\n                //console.log(\"Failed with status \" + xhr.status + \" \" + xhr.responseText);\r\n            }\r\n            else {\r\n                \r\n                var obj = JSON.parse(xhr.responseText);\r\n                throw new Error(obj.error.code + \": \" + obj.error.message);\r\n            }\r\n        };\r\n        \r\n        xhr.open(requestType.toUpperCase(), url);\r\n        xhr.withCredentials = false;\r\n        xhr.setRequestHeader(\"Accept\", \"application/json\");\r\n        if (requestType.toUpperCase() == \"PUT\" || requestType.toUpperCase() == \"POST\" || requestType.toUpperCase() == \"PATCH\") {\r\n            xhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n        }\r\n        xhr.send(data);\r\n}\r\n\r\nvar data = JSON.stringify({\r\n    \"to\": \"+6598685580\",\r\n    \"from\": \"\",\r\n    \"body\": \"Hello World from Node.js!\"\r\n});\r\n\r\nrun(\"https://api.twilio.com/2010-04-01/Accounts/ACf9222edb22d1a89b604f81c77c64ffb1/Messages.json\", data, \"POST\", function(responseObj) {\r\n    console.log(responseObj);\r\n});"],"names":["url","data","requestType","cb","xhr","XMLHttpRequest","onreadystatechange","readyState","status","obj","JSON","parse","responseText","Error","error","code","message","startswith","open","toUpperCase","withCredentials","setRequestHeader","send","run","stringify","responseObj","console","log"],"mappings":"cAEA,SAAaA,EAAaC,EAAcC,EAAqBC,OACrDC,EAAM,IAAIC,eACVD,EAAIE,mBAAqB,cACE,IAAnBF,EAAIG,cAEU,KAAdH,EAAII,OAAe,KAEfC,EAAMC,KAAKC,MAAMP,EAAIQ,cACP,mBAAPT,GACPA,EAAGM,QAEN,GAAkB,KAAdL,EAAII,OACS,mBAAPL,GACPA,EAAGC,EAAIQ,mBAEV,GAAkB,KAAdR,EAAII,OAAe,CACpBC,EAAMC,KAAKC,MAAMP,EAAIQ,cAGP,mBAAPT,GACPA,EAAGM,QAEN,GAAkB,KAAdL,EAAII,OACS,mBAAPL,GACPA,EAAG,UAEN,CAAA,GAAkB,KAAdC,EAAII,OAAe,CAEpBC,EAAMC,KAAKC,MAAMP,EAAIQ,oBACnB,IAAIC,MAAMJ,EAAIK,MAAMC,KAAO,KAAON,EAAIK,MAAME,SAEjD,GAAkB,KAAdZ,EAAII,OAcR,CAEGC,EAAMC,KAAKC,MAAMP,EAAIQ,oBACnB,IAAIC,MAAMJ,EAAIK,MAAMC,KAAO,KAAON,EAAIK,MAAME,YAbnB,gCAH3BP,EAAMC,KAAKC,MAAMP,EAAIQ,eAEFE,MAAME,QACZC,iBAIP,IAAIJ,MAAMJ,EAAIK,MAAMC,KAAO,KAAON,EAAIK,MAAME,WAa9DZ,EAAIc,KAAKhB,EAAYiB,cAAenB,GACpCI,EAAIgB,iBAAkB,EACtBhB,EAAIiB,iBAAiB,SAAU,oBACE,OAA7BnB,EAAYiB,eAAuD,QAA7BjB,EAAYiB,eAAwD,SAA7BjB,EAAYiB,eACzFf,EAAIiB,iBAAiB,eAAgB,oBAEzCjB,EAAIkB,KAAKrB,GASjBsB,CAAI,8FANOb,KAAKc,UAAU,IAChB,mBACE,QACA,8BAG6F,QAAQ,SAASC,GACtHC,QAAQC,IAAIF"}